{% extends 'base.html' %}
{% load static %}

{% block title %}Completar Reserva - {{ hotel.nombre }}{% endblock %}

{% block content %}
<div class="reserva-container">
    <!-- Pasos del proceso -->
    <div class="reserva-steps">
        <div class="reserva-step completed">
            <div class="step-circle">1</div>
            <span class="step-label">Fecha y Personas</span>
        </div>
        <div class="reserva-step completed">
            <div class="step-circle">2</div>
            <span class="step-label">Seleccionar Habitación</span>
        </div>
        <div class="reserva-step active">
            <div class="step-circle">3</div>
            <span class="step-label">Datos Personales</span>
        </div>
        <div class="reserva-step">
            <div class="step-circle">4</div>
            <span class="step-label">Confirmación</span>
        </div>
    </div>
    
    <div class="row">
        <!-- Formulario -->
        <div class="col-lg-8">
            <div class="form-card">
                <div class="form-header">
                    <h2>Completar tus datos</h2>
                    <p>Por favor completa la siguiente información para finalizar tu reserva</p>
                </div>
                
                <form method="POST">
                    {% csrf_token %}
                    
                    <div class="row g-4">
                        <!-- Nombre -->
                        <div class="col-md-6">
                            <div class="form-floating-custom">
                                <input type="text" 
                                       class="form-control" 
                                       id="nombre"
                                       name="nombre"
                                       placeholder="Tu nombre completo"
                                       required>
                                <label for="nombre">
                                    <i class="fas fa-user me-2"></i>Nombre completo
                                </label>
                            </div>
                        </div>
                        
                        <!-- Email -->
                        <div class="col-md-6">
                            <div class="form-floating-custom">
                                <input type="email" 
                                       class="form-control" 
                                       id="email"
                                       name="email"
                                       placeholder="tu@email.com"
                                       required>
                                <label for="email">
                                    <i class="fas fa-envelope me-2"></i>Correo electrónico
                                </label>
                            </div>
                        </div>
                        
                        <!-- Teléfono -->
                        <div class="col-12">
                            <div class="form-floating-custom">
                                <input type="tel" 
                                       class="form-control" 
                                       id="telefono"
                                       name="telefono"
                                       placeholder="+54 11 1234-5678"
                                       required>
                                <label for="telefono">
                                    <i class="fas fa-phone me-2"></i>Teléfono de contacto
                                </label>
                            </div>
                        </div>
                        
                        <!-- Notas adicionales -->
                        <div class="col-12">
                            <div class="form-floating-custom">
                                <textarea class="form-control" 
                                          id="notas"
                                          name="notas"
                                          placeholder="¿Alguna solicitud especial?"
                                          rows="3"></textarea>
                                <label for="notas">
                                    <i class="fas fa-sticky-note me-2"></i>Notas adicionales (opcional)
                                </label>
                            </div>
                        </div>
                        
                        <!-- Términos y condiciones -->
                        <div class="col-12">
                            <div class="form-check">
                                <input class="form-check-input" 
                                       type="checkbox" 
                                       id="terminos" 
                                       required>
                                <label class="form-check-label" for="terminos">
                                    Acepto los <a href="#" class="text-primary">términos y condiciones</a> 
                                    y la <a href="#" class="text-primary">política de privacidad</a>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Botones -->
                    <div class="nav-buttons">
                        <a href="{% url 'seleccionar_habitacion' %}" class="btn-secondary">
                            <i class="fas fa-arrow-left me-1"></i> Volver
                        </a>
                        <button type="submit" class="btn-primary">
                            Confirmar reserva 
                            <i class="fas fa-check ms-2"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Resumen -->
        <div class="col-lg-4">
            <div class="reserva-summary sticky-top" style="top: 20px;">
                <div class="summary-item">
                    <div class="summary-icon">
                        <i class="fas fa-hotel"></i>
                    </div>
                    <div class="summary-content">
                        <h5>Hotel</h5>
                        <p>{{ hotel.nombre }}</p>
                    </div>
                </div>
                
                <div class="summary-item">
                    <div class="summary-icon">
                        <i class="fas fa-bed"></i>
                    </div>
                    <div class="summary-content">
                        <h5>Habitación</h5>
                        <p>N° {{ habitacion.numero }}</p>
                        <small class="text-muted">{{ habitacion.cantidad_plazas }} plaza{{ habitacion.cantidad_plazas|pluralize }}</small>
                    </div>
                </div>
                
                <div class="summary-item">
                    <div class="summary-icon">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="summary-content">
                        <h5>Fecha</h5>
                        <p>{{ fecha_formateada }}</p>
                    </div>
                </div>
                
                <div class="summary-item">
                    <div class="summary-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="summary-content">
                        <h5>Personas</h5>
                        <p>{{ cantidad_personas }} persona{{ cantidad_personas|pluralize }}</p>
                    </div>
                </div>
                
                <hr>
                
                <!-- Precio total -->
                <div class="summary-price">
                    <div class="price-total">
                        ${{ habitacion.cantidad_plazas|add:"0"|floatformat:0 }}0
                    </div>
                    <div class="price-label">Total por noche</div>
                    <small class="text-muted d-block mt-2">
                        Impuestos incluidos
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Validación de formulario
document.querySelector('form').addEventListener('submit', function(e) {
    const terminos = document.getElementById('terminos');
    if (!terminos.checked) {
        e.preventDefault();
        alert('Debes aceptar los términos y condiciones para continuar.');
        terminos.focus();
        return false;
    }
});
</script>
{% endblock %}